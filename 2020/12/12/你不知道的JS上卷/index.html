<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="知识在世界的某个角落等你">
    <meta name="author" content="Chao">
    
    <title>
        
            《你不知道的JS上卷》 |
        
        XChao&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/avatar.jpg">
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"xiongcao.github.io","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/avatar.jpg","favicon":"/images/avatar.jpg","avatar":"/images/avatar.jpg","font_size":null,"font_family":null,"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"黄色的森林分出两条路，我选择人迹更少的那一条，从此决定我一生的道路。","font_color":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":"https://bear-blog-comment-8yis8zzwo-xiongcao.vercel.app","reaction":true,"version":2}},"post":{"author_label":{"enable":true,"auto":false,"custom_label_list":["Trainee","Engineer","Architect","实习生","工程师","架构师","程序鼓励师"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/avatar.jpg">
                </a>
            
            <a class="logo-title" href="/">
               XChao&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">《你不知道的JS上卷》</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Chao</span>
                            
                                <span class="author-label">工程师</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2020-12-12 13:15:00</span>
        <span class="mobile">2020-12-12 13:15</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-07-20 14:56:01</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/JS/">JS</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/JS/">JS</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>5.5k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>21 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <span id="more"></span>

<h2 id="第一部分：作用域和闭包"><a href="#第一部分：作用域和闭包" class="headerlink" title="第一部分：作用域和闭包"></a>第一部分：作用域和闭包</h2><h3 id="第1章：作用域"><a href="#第1章：作用域" class="headerlink" title="第1章：作用域"></a>第1章：作用域</h3><h4 id="1-1-编译原理"><a href="#1-1-编译原理" class="headerlink" title="1.1. 编译原理"></a>1.1. 编译原理</h4><blockquote>
<p>所谓编译指的是：源代码执行之前进行的操作。</p>
</blockquote>
<p>而对于 <code>JS</code> 而言，它的整个编译过程被粗略分为三大步：</p>
<ol>
<li>分词 - &#x3D;&#x3D;词法分析&#x3D;&#x3D;</li>
<li>解析 - &#x3D;&#x3D;语法分析&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;代码生成&#x3D;&#x3D;</li>
</ol>
<p>首先对于 <strong>词法分析</strong> 而言，它的主要作用就是： <strong>把一段 <code>JS</code> 代码，解析成多个词法单元（<code>token</code>）</strong>。我们以 <code>var a = 2;</code> 为例，他会被解析成 <code>5</code> 个 <code>token</code>：<code>var、a、=、2、;</code></p>
<p>其次是 <strong>语法分析</strong>，它的作用是： **把 <code>token</code> 流转化为 <code>AST （抽象语法树）</code> **。所谓抽象语法树就是一个 <strong>树形结构的 <code>JS</code> 对象</strong></p>
<p>最后是 <strong>代码生成</strong>，它的作用是：<strong>把 <code>AST</code> 解析成可执行的代码（机器指令）</strong></p>
<h4 id="1-2-理解作用域"><a href="#1-2-理解作用域" class="headerlink" title="1.2. 理解作用域"></a>1.2. 理解作用域</h4><p>明确好了这三步基础的 <code>JS 编译原理</code> 之后，那么下面我们来尝试理解一下作用域。</p>
<p>作者告诉我们：“作用域的理解需要从一个故事开始~~”。</p>
<p>既然是故事嘛，那肯定得有演员。咱们这次出动了三个演员：</p>
<ol>
<li><p>&#x3D;&#x3D;引擎&#x3D;&#x3D;：负责整个 JavaScript 程序的&#x3D;&#x3D;编译及执行&#x3D;&#x3D;过程（核心）</p>
</li>
<li><p>&#x3D;&#x3D;编译器&#x3D;&#x3D;：负责语法分析及代码生成等（编译三步）</p>
</li>
<li><p>&#x3D;&#x3D;作用域&#x3D;&#x3D;：负责收集并维护由所有变量查询，并确定访问权限</p>
</li>
</ol>
<p>明确好这些演员之后，接下来咱们来看这个故事：</p>
<blockquote>
<p><strong>引擎</strong> 有一天看见了一段代码 <code>var a = 2; </code>，这段代码在引擎看来是两段完全不同的内容，所以引擎把这段代码拆成了两部分：</p>
<ol>
<li><code>var a</code></li>
<li><code>a = 2</code></li>
</ol>
<p>然后把第一段代码交给了 <strong>编译器</strong>，编译器就拿着这段代码问 <strong>作用域</strong>，你那有 <code>a</code> 这个变量吗？作用域如果说有，那么编译器就会忽略掉这段声明。否则，则进行 <code>a</code> 变量声明。</p>
<p>接下来，<strong>编译器</strong> 会为 <strong>引擎</strong> 生成运行时所需的代码，这些代码被用来处理 <code>a = 2</code> 这个赋值操作。</p>
<p><strong>引擎</strong> 会首先询问 <strong>作用域</strong>：在当前的作用域集合中是否存在一个叫作 <code>a</code> 的 变量。如果是，<strong>引擎</strong> 就会使用这个变量。否则，<strong>引擎</strong> 会继续查找该变量（这就涉及到另外一个概念 <strong>作用域嵌套</strong>）。</p>
</blockquote>
<p>在这样的一个故事中，会涉及到两个关键术语：&#x3D;&#x3D;LHS&#x3D;&#x3D; 和 &#x3D;&#x3D;RHS&#x3D;&#x3D;。</p>
<ul>
<li><code>LHS</code>：赋值操作的左侧查询。这并不意味着 <code>LHS</code> 就是赋值符号左侧的操作。大家可以用这句话进行理解 <strong>找到变量，对其赋值</strong></li>
<li><code>RHS</code>：赋值操作的右侧查询。同样的道理，它也并不是赋值符号的右侧操作。大家可以用这句话进行理解 <strong>取得某变量的值</strong></li>
</ul>
<p>如果只是这么说，可能大多数同学依然听不懂，咱们下面通过一个例子来看一下。</p>
<blockquote>
<p>function foo(a) { </p>
<p>​	console.log( a ); &#x2F;&#x2F; 2 </p>
<p>}</p>
<p>foo( 2 ); </p>
</blockquote>
<p>让我们把上面这段代码的处理过程想象成一段对话，这段对话可能是下面这样的。 </p>
<blockquote>
<p>引擎：我说作用域，我需要为foo进行RHS引用。你见过它吗？ </p>
<p>作用域：别说，我还真见过，编译器那小子刚刚声明了它。它是一个函数，给你。 </p>
<p>引擎：哥们太够意思了！好吧，我来执行一下foo。 </p>
<p>引擎：作用域，还有个事儿。我需要为a进行LHS引用，这个你见过吗？ </p>
<p>作用域：这个也见过，编译器最近把它声名为foo的一个形式参数了，拿去吧。 </p>
<p>引擎：大恩不言谢，你总是这么棒。现在我要把2赋值给a。 </p>
<p>引擎：哥们，不好意思又来打扰你。我要为console进行RHS引用，你见过它吗？ </p>
<p>作用域：咱俩谁跟谁啊，再说我就是干这个的。这个我也有，console是个内置对象。给你。 </p>
<p>引擎：么么哒。我得看看这里面是不是有log(..)。太好了，找到了，是一个函数。 </p>
<p>引擎：哥们，能帮我再找一下对a的RHS引用吗？虽然我记得它，但想再确认一次。 </p>
<p>作用域：放心吧，这个变量没有变动过，拿走，不谢。 </p>
<p>引擎：真棒。我来把a的值，也就是2，传递进log(..)。 </p>
<p>查询步骤为：</p>
<ol>
<li>RHS：foo(2)</li>
<li>LHS：a &#x3D; 2</li>
<li>RHS：console</li>
<li>RHS：xxx.log(a)</li>
</ol>
</blockquote>
<h4 id="1-3-作用域嵌套"><a href="#1-3-作用域嵌套" class="headerlink" title="1.3. 作用域嵌套"></a>1.3. 作用域嵌套</h4><p>当一个块或函数嵌套在另一个块或函数中时，就发生了作用域的嵌套。因此，在当前作用域中无法 </p>
<p>找到某个变量时，引擎就会在外层嵌套的作用域中继续查找，直到找到该变量，或抵达最外层的作用域（也就是全局作用域）为止。 </p>
<p>考虑以下代码： </p>
<blockquote>
<p>function foo(a) { </p>
<p>​	console.log( a + b ); </p>
<p>}</p>
<p>var b &#x3D; 2; </p>
<p>foo( 2 ); &#x2F;&#x2F; 4 </p>
</blockquote>
<p>对b进行的RHS引用无法在函数foo内部完成，但可以在上一级作用域（在这个例子中就是全局作用域）中完成。 </p>
<p>遍历嵌套作用域链的规则很简单：引擎从当前的执行作用域开始查找变量，如果找不到，就向上一级继续查找。当抵达最外层的全局作用域时，无论找到还是没找到，查找过程都会停止。 </p>
<h4 id="1-4-异常"><a href="#1-4-异常" class="headerlink" title="1.4. 异常"></a>1.4. 异常</h4><p>在 <strong>逐层向上</strong> 的查找过程中，引擎会从变量当前作用域开始，一直查找到全局作用域。如果到全局作用域还如法查找到变量的话，那么就会抛出 <code>ReferenceError 异常</code> 。</p>
<p><code>ReferenceError 异常</code> 表示 <strong>RHS 查询在所有嵌套的作用域中遍寻不到所需的变量</strong>。</p>
<p>而对于 <code>LHS 查询</code> 而言，如果在非严格模式下（例 <code>a = 2</code>），<strong>编译器会在全局作用于下声明该变量，然后再为其赋值</strong>。</p>
<p>而如果在严格模式下，同样会抛出 <code>ReferenceError 异常</code></p>
<hr>
<h3 id="第2章：词法作用域"><a href="#第2章：词法作用域" class="headerlink" title="第2章：词法作用域"></a>第2章：词法作用域</h3><h4 id="2-1词法阶段"><a href="#2-1词法阶段" class="headerlink" title="2.1词法阶段"></a>2.1词法阶段</h4><p>简单地说，词法作用域就是定义在词法阶段的作用域。换句话说，词法作用域是由你在写代码时将 </p>
<p>变量和块作用域写在哪里来决定的，因此当词法分析器处理代码时会保持作用域不变（大部分情 </p>
<p>况下是这样的）</p>
<img  
                     lazyload
                     alt="image"
                     data-src="/Users/xiongchao/Library/Application Support/typora-user-images/image-20230407100836937.png"
                      alt="image-20230407100836937" style="zoom:30%;" align="left"
                >

<p>在这段代码中，我们知道它包含了三级作用域：</p>
<ul>
<li>① 包含着整个全局作用域，其中只有一个标识符：<code>foo</code></li>
<li>② 包含着 <code>foo</code> 所创建的作用域，其中有三个标识符：<code>a</code>、<code>bar</code> 和 <code>b</code></li>
<li>③ 包含着 <code>bar</code> 所创建的作用域，其中只有一个标识符：<code>c</code></li>
</ul>
<p>这三个作用域其实就是词法作用域的概念。</p>
<h4 id="2-2-欺骗词法"><a href="#2-2-欺骗词法" class="headerlink" title="2.2 欺骗词法"></a><strong>2.2</strong> 欺骗词法</h4><p>如果词法作用域完全由写代码期间函数所声明的位置来定义，怎样才能在运行时来“修改”（也可以说欺骗）词法作用域呢？ </p>
<p>JavaScript中有两种机制来实现这个目的。社区普遍认为在代码中使用这两种机制并不是什么好主意。但是关于它们的争论通常会忽略掉最重要的点：&#x3D;&#x3D;欺骗词法作用域会导致性能下降&#x3D;&#x3D;。</p>
<p> <code>JS</code> 中为我们提供了两个 <code>API</code> 来 “欺骗” 作用域，也就是 <strong>欺骗词法</strong>。</p>
<h5 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h5><p><code>eval()</code> 函数会将传入的字符串当做 <code>JavaScript</code> 代码进行执行。利用该语法我们可以把 <strong>指定代码，指定在局部作用域下执行</strong>：</p>
<blockquote>
<p>function foo(str, a) { </p>
<p>​	eval( str ); &#x2F;&#x2F; 欺骗！ </p>
<p>​	console.log( a, b ); </p>
<p>}</p>
<p>var b &#x3D; 2; </p>
<p>foo( “var b &#x3D; 3;”, 1 ); &#x2F;&#x2F; 1, 3 </p>
</blockquote>
<h5 id="with"><a href="#with" class="headerlink" title="with"></a>with</h5><p>它的作用是 <strong>扩展一个语句的作用域链</strong>。比如在如下代码中 <code>with</code> 内的代码，会自动指向 <code>obj</code> 对象：</p>
<p>![image-20230407102605990](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407102605990.png)</p>
<p>但是要注意，<code>with</code> 语法可能会导致内存泄漏：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="title function_">with</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">    a = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">foo</span>(&#123;&#125;)</span><br><span class="line">consle.<span class="title function_">log</span>(a); <span class="comment">// 2, a被泄漏到全局作用域上了！</span></span><br></pre></td></tr></table></figure>

<p>并且 <code>with</code> 会让作用域变得混乱，所以 <strong>它是一个不被推荐使用的语法</strong>。</p>
<p>不光是 <code>with</code>，包括 <code>eval</code> ，它们两个都不应该是我们在日常开发时的首选项，因为它们改变作用域的特性，会导致 <strong>引擎无法在编译时对作用域查找进行优化</strong> ，所以我们应该尽量避免使用 <code>eval</code> 和 <code>with</code>。</p>
<hr>
<h3 id="第3章：函数作用域与块作用域"><a href="#第3章：函数作用域与块作用域" class="headerlink" title="第3章：函数作用域与块作用域"></a>第3章：函数作用域与块作用域</h3><p>首先针对函数作用于而言，它表示 <strong>一个函数的作用域范围。属于这个函数的全部变量都可以在整个函数的范围内使用及复用</strong></p>
<p>我们之前很多次的说过 <strong>函数是 js 世界的第一公民</strong>。创建函数的目的，本质上其实就是为了 <strong>把代码 “隐藏” 起来</strong>。也就是 <strong>最小特权原则</strong>。</p>
<p>所谓 <strong>最小特权原则</strong>，指的是：<strong>最小限度地暴露必要内容，而将其他内容都“隐藏”起来</strong>。</p>
<h4 id="隐藏内部实现"><a href="#隐藏内部实现" class="headerlink" title="隐藏内部实现"></a>隐藏内部实现</h4><p>但是在某些情况下，如果我们的代码不够完善的话，那么虽然创建了函数，但是依然不符合最小特权原则。比如下面这段代码：</p>
<p>![image-20230407103832164](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407103832164.png)</p>
<p>在这段代码中，我们声明了一个全局变量 <code>var b</code>。然后在函数中对 <code>b</code> 进行了操作。但是因为 <code>b</code> 是全局变量，所以我们可以在任意位置修改 <code>b</code> 的值，那么这样的一个操作就是 “非常危险” 的。此时的代码就不符合最小特权原则。</p>
<p>我们可以对当前代码进行下修改，把 <code>b</code> 的定义放到函数之后，以避免被全局访问 ：</p>
<p>![image-20230407103619173](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407103619173.png)</p>
<p><strong>规避冲突</strong></p>
<p>![image-20230407104059592](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407104059592.png)</p>
<p><code>ECMAScript</code> 在 <code>ES6</code> 之后新增了 <code>let</code> 和 <code>const</code> 两个声明变量的关键字，这两个关键字具备块级作用域（<code>&#123;&#125;</code> 组成块级作用域），同时 <code>var</code> 也不再被推荐使用了。所以冲突问题倒是可以比较轻松的避免。</p>
<hr>
<h3 id="第4章：提升"><a href="#第4章：提升" class="headerlink" title="第4章：提升"></a>第4章：提升</h3><h4 id="4-1-变量提升"><a href="#4-1-变量提升" class="headerlink" title="4.1 变量提升"></a>4.1 变量提升</h4><p>所谓提升指的是 <strong>变量提升</strong> 的问题，什么是变量提升呢？咱们来看这两段代码：</p>
<p>![image-20230407105947634](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407105947634.png)</p>
<p>![image-20230407110000228](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110000228.png)</p>
<p>大家可以猜一下这两段代码输出的内容是什么？</p>
<p>第一段代码的输出结果是 <code>2</code>。</p>
<p>第二段代码的输出结果是 <code>undefined</code>。</p>
<p>如果我们从一个标准的程序设计角度，这样的代码是肯定不能正常运行的。但是因为 <code>var</code> 存在变量提升的问题，所以我们得到了以上两个对应的输出结果。</p>
<p>那么这个变量提升到底是怎么提升的呢？此时啊，编译器就有话说了。</p>
<p>整个 <code>var a = 2;</code> 的代码编译器在处理会分成两部分：</p>
<ol>
<li>在 编译阶段，进行定义声明：<code>var a</code></li>
<li>在 执行阶段，进行赋值声明：<code>a = 2</code></li>
</ol>
<p>根据声明提升，第一段代码会被解析为以下代码：</p>
<p>![image-20230407110044411](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110044411.png)</p>
<p>第二段代码会被解析为以下代码：</p>
<p>![image-20230407110104747](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110104747.png)</p>
<h4 id="4-2-函数优先"><a href="#4-2-函数优先" class="headerlink" title="4.2 函数优先"></a>4.2 函数优先</h4><p>而对于函数而言，同样存在变量提升的问题，同时 <strong>当函数和变量同时需要提升时</strong>，遵循 <strong>函数优先原则</strong>。例如，以下代码：</p>
<p>![image-20230407110408667](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110408667.png)</p>
<p>被提升之后的内容为：</p>
<p>![image-20230407110449859](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110449859.png)</p>
<p>注意，var foo尽管出现在function foo()…的声明之前，但它是重复的声明（因此被忽略了），因为 </p>
<p>函数声明会被提升到普通变量之前。 </p>
<p>尽管重复的var声明会被忽略掉，但出现在&#x3D;&#x3D;后面的函数声明&#x3D;&#x3D;还是可以&#x3D;&#x3D;覆盖前面&#x3D;&#x3D;的。 </p>
<p>![image-20230407110645895](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407110645895.png)</p>
<hr>
<h3 id="第5章：作用域闭包"><a href="#第5章：作用域闭包" class="headerlink" title="第5章：作用域闭包"></a>第5章：作用域闭包</h3><p>到这里，对作用域咱们了解的其实就差不多了。作者分别从 <strong>词法作用域、函数作用域、块作用域</strong> 三个方面对作用域进行了解释。</p>
<p>那么什么是闭包呢？所为闭包一定是一个函数。通常情况下我们把 <strong>能够访问其它函数作用域中变量的函数</strong> 叫做闭包函数。</p>
<p>闭包函数在前端开发中是非常常见的，比如：</p>
<p>![image-20230407141834715](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407141834715.png)</p>
<p>![image-20230407141903755](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407141903755.png)</p>
<h4 id="循环和闭包"><a href="#循环和闭包" class="headerlink" title="循环和闭包"></a>循环和闭包</h4><p>要说明闭包，for循环是最常见的例子。 </p>
<p>![image-20230407142116582](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407142116582.png)</p>
<blockquote>
<p>正常情况下，我们对这段代码行为的预期是分别输出数字1~5，每秒一次，每次一个。 </p>
<p>但实际上，这段代码在运行时会以每秒一次的频率输出五次6。 </p>
<p>首先解释6是从哪里来的。这个循环的终止条件是i不再&lt;&#x3D;5。条件首次成立时i的值是6。因此，输出显示的是循环结束时i的最终值。 </p>
<p>仔细想一下，这好像又是显而易见的，延迟函数的回调会在循环结束时才执行。事实上，当定时器运行时即使每个迭代中执行的是setTimeout(.., 0)，所有的回调函数依然是在循环结束后才会被执行，因此会每次输出一个6出来。 </p>
</blockquote>
<p>我们需要更多的闭包作用域，特别是在循环的过程中每个迭代都需要一个闭包作用域.</p>
<p>第3章介绍过，IIFE会通过&#x3D;&#x3D;声明并立即执行一个函数来创建作用域&#x3D;&#x3D;。 </p>
<p>我们来试一下： </p>
<p>![image-20230407142329128](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407142329128.png)</p>
<blockquote>
<p>这样也不行。我们现在显然拥有更多的词法作用域了。的确每个延迟函数都会将IIFE在每次迭代中创建的作用域封闭起来。 </p>
<p>如果作用域是空的，那么仅仅将它们进行封闭是不够的。仔细看一下，我们的IIFE只是一个什么都没有的空作用域。它需要包含一点实质内容才能为我们所用。 </p>
</blockquote>
<p>它需要有自己的变量，用来在每个迭代中储存i的值： </p>
<p>![image-20230407142546985](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407142546985.png)</p>
<p>行了！它能正常工作了！。 </p>
<p>可以对这段代码进行一些改进：</p>
<p>![image-20230407142610723](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407142610723.png)</p>
<p>重返<strong>块作用域</strong> </p>
<p>我们使用IIFE在每次迭代时都创建一个新的作用域。换句话说，每次迭代我们都需要一个块作用域。第3章介绍let声明，可以用来劫持块作用域，并且在这个块作用域中声明一个变量</p>
<p>本质上这是将一个块转换成一个可以被关闭的作用域。因此，下面这些看起来很酷的代码就可以正常运行了： </p>
<p>![image-20230407143050841](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407143050841.png)</p>
<p>但是，这还不是全部！for循环头部的let声明还会有一个特殊的行为。这个行为指出变量在循环过程中不止被声明一次，每次迭代都会声明。随后的&#x3D;&#x3D;每个迭代都会使用上一个迭代结束时的值&#x3D;&#x3D;来初始化这个变量。 </p>
<p>![image-20230407143211762](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407143211762.png)</p>
<h2 id="第二部分：this-和-对象原型"><a href="#第二部分：this-和-对象原型" class="headerlink" title="第二部分：this 和 对象原型"></a>第二部分：this 和 对象原型</h2><h3 id="第1章：关于this"><a href="#第1章：关于this" class="headerlink" title="第1章：关于this"></a>第1章：关于this</h3><p>所谓 <code>this</code> ，大家首先需要知道 <strong>它是在运行时进行绑定的，它的上下文取决于函数调用时的各种条件。</strong> 也就是说， <code>this</code> 的值到底是什么，取决于它所在的函数被调用时的上下文，而和它所在的函数定义时没有关系。</p>
<p>同时大家要注意，以上这些描述 <strong>仅针对于 <code>function</code> 声明的普通函数</strong>，因为我们知道 <strong>箭头函数是不会修改 <code>this</code> 指向的。</strong></p>
<h3 id="第2章：this全面解析"><a href="#第2章：this全面解析" class="headerlink" title="第2章：this全面解析"></a>第2章：this全面解析</h3><h4 id="2-1-绑定规则"><a href="#2-1-绑定规则" class="headerlink" title="2.1 绑定规则"></a>2.1 绑定规则</h4><h5 id="2-1-1-默认绑定"><a href="#2-1-1-默认绑定" class="headerlink" title="2.1.1 默认绑定"></a>2.1.1 默认绑定</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// this 指向 window。即：this.a === window.a</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// foo() 等同于 window.foo()</span></span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>如果使用严格模式（strict mode），那么全局对象将无法使用默认绑定，因此this会绑定到undefined： </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123; </span><br><span class="line">  <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="variable language_">this</span>.<span class="property">a</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="title function_">foo</span>(); <span class="comment">// TypeError: this is undefined</span></span><br></pre></td></tr></table></figure>



<h5 id="2-1-2-隐式绑定"><a href="#2-1-2-隐式绑定" class="headerlink" title="2.1.2 隐式绑定"></a>2.1.2 隐式绑定</h5><p>以对象方法的形式进行的函数调用，此时 <code>this</code> 指向调用该函数的对象：</p>
<p>![image-20230407151233142](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407151233142.png)</p>
<p>对象属性引用链中只有最顶层或者说最后一层会影响调用位置。举例来说： </p>
<p>![image-20230407151350054](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407151350054.png)</p>
<p><strong>隐式丢失</strong> </p>
<p>一个最常见的this绑定问题就是被隐式绑定的函数会丢失绑定对象，也就是说它会应用默认绑定，从而&#x3D;&#x3D;把this绑定到全局对象&#x3D;&#x3D;或者undefined上，取决于是否是严格模式。</p>
<p>![image-20230407151604958](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407151604958.png)</p>
<p>虽然bar是obj.foo的一个引用，但是实际上，它引用的是foo函数本身，因此此时的bar()其实是一个不带任何修饰的函数调用，因此应用了默认绑定。</p>
<p>一种更微妙、更常见并且更出乎意料的情况发生在传入回调函数时： </p>
<p>![image-20230407153502347](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407153502347.png)</p>
<p>&#x3D;&#x3D;参数传递&#x3D;&#x3D;其实就是一种&#x3D;&#x3D;隐式赋值&#x3D;&#x3D;，因此我们传入函数时也会被隐式赋值，所以结果和上一个例子一样。</p>
<p>JavaScript环境中内置的setTimeout()函数实现和下面的伪代码类似： </p>
<p>![image-20230407153651576](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407153651576.png)</p>
<h5 id="2-1-3-显式绑定"><a href="#2-1-3-显式绑定" class="headerlink" title="2.1.3 显式绑定"></a>2.1.3 显式绑定</h5><ul>
<li>call (obj, p1, p2, …)</li>
<li>apply (obj, [ p1, p2, …])</li>
<li>bind(obj)(p1, p2, …)</li>
</ul>
<h5 id="2-1-4-new绑定"><a href="#2-1-4-new绑定" class="headerlink" title="2.1.4 new绑定"></a>2.1.4 new绑定</h5><p>主要针对构造函数。在这种情况下 <code>this</code> 指向构造生成的实例对象</p>
<p>![image-20230407154658360](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407154658360.png)</p>
<h4 id="2-2-绑定例外"><a href="#2-2-绑定例外" class="headerlink" title="2.2 绑定例外"></a>2.2 绑定例外</h4><h5 id="2-2-1-被忽略的-this"><a href="#2-2-1-被忽略的-this" class="headerlink" title="2.2.1 被忽略的 this"></a>2.2.1 被忽略的 this</h5><p>如果你把null或者undefined作为this的绑定对象传入call、apply或者bind，这些值在调用时会被 忽略，实际应用的是&#x3D;&#x3D;默认绑定规则&#x3D;&#x3D;</p>
<p>![image-20230407155143182](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407155143182.png)</p>
<h5 id="2-2-2-间接引用"><a href="#2-2-2-间接引用" class="headerlink" title="2.2.2  间接引用"></a>2.2.2  间接引用</h5><p>间接引用最容易在赋值时发生</p>
<p>![image-20230407155523469](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407155523469.png)</p>
<p>赋值表达式p.foo &#x3D; o.foo的返回值是目标函数的引用，因此&#x3D;&#x3D;调用位置是foo()&#x3D;&#x3D;而不是p.foo()或 者o.foo()。根据我们之前说过的，这里会应用&#x3D;&#x3D;默认绑定&#x3D;&#x3D;。 </p>
<hr>
<h3 id="第3章：对象"><a href="#第3章：对象" class="headerlink" title="第3章：对象"></a>第3章：对象</h3><h4 id="3-1-类型"><a href="#3-1-类型" class="headerlink" title="3.1 类型"></a>3.1 类型</h4><p>基础类型：<code>stirng</code>, <code>number</code>, <code>boolean</code>, <code>undefined</code>, <code>null</code>  ES6新增了两种，<code>symbol</code>, <code>bigint</code></p>
<p>引用类型：<code>object</code></p>
<p>typeof的值：<code>stirng</code>, <code>number</code>, <code>boolean</code>, <code>undefined</code>, <code>object</code>, <code>function</code>, <code>symbol</code></p>
<h4 id="3-2-复制对象"><a href="#3-2-复制对象" class="headerlink" title="3.2 复制对象"></a>3.2 复制对象</h4><h5 id="3-2-1-浅拷贝："><a href="#3-2-1-浅拷贝：" class="headerlink" title="3.2.1 浅拷贝："></a>3.2.1 浅拷贝：</h5><p>浅拷贝表示多个变量引用了同一块内存地址。</p>
<p>操作方式也比较简单，可以直接通过 <code>= 赋值符</code> 或 <code>Object.assgin</code> 进行实现。</p>
<h5 id="3-2-2-深拷贝："><a href="#3-2-2-深拷贝：" class="headerlink" title="3.2.2 深拷贝："></a>3.2.2 深拷贝：</h5><ul>
<li>浅层的深拷贝：<code>JSON.parse( JSON.stringify( obj ) )</code></li>
<li>深层的深拷贝:  递归。（如：Lodash.cloneDeep()）</li>
</ul>
<h4 id="3-3-属性描述符"><a href="#3-3-属性描述符" class="headerlink" title="3.3 属性描述符"></a>3.3 属性描述符</h4><p>对象中每个属性，都存在属性描述符。可以通过 <a class="link"   target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor" >Object.getOwnPropertyDescriptor()<i class="fas fa-external-link-alt"></i></a> 方法来获取对应的属性描述符。不同的属性描述符代表了不同的作用：</p>
<p>![image-20230407163515085](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407163515085.png)</p>
<ol>
<li>**<code>value</code>**：该属性的值 (仅针对数据属性描述符有效)</li>
<li>**<code>writable</code>**：当且仅当属性的值可以被改变时为 <code>true</code>。</li>
<li>**<code>configurable</code>**：当且仅当指定对象的属性描述可以被改变或者属性可被删除时，为 <code>true</code>。</li>
<li>**<code>enumerable</code>**：当且仅当指定对象的属性可以被枚举出时，为 <code>true</code>。</li>
</ol>
<p>也可以通过 <a class="link"   target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" >Object.defineProperty()<i class="fas fa-external-link-alt"></i></a> 方法修改指定属性的属性描述符。</p>
<p>![image-20230407163456199](&#x2F;Users&#x2F;xiongchao&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20230407163456199.png)</p>
<h4 id="3-4-不变性"><a href="#3-4-不变性" class="headerlink" title="3.4 不变性"></a>3.4 不变性</h4><p>对象属性不可变的方法：</p>
<ol>
<li>对象常量：结合 <code>writable:false</code> 和 <code>configurable:false</code> 就可以创建一个真正的常量属性</li>
<li>禁止扩展：<code>Object.preventExtensions(..)</code>。（不允许添加属性）</li>
<li>密封：<code>Object.seal</code>。（调用preventExtensions，并标记为configurable: false。不能添加、配置、删除）</li>
<li>冻结：<code>Object.freeze()</code>。（调用Object.seal，标记为writable: false。全都不能）</li>
</ol>
<h4 id="3-5-遍历"><a href="#3-5-遍历" class="headerlink" title="3.5 遍历"></a>3.5 遍历</h4><p><code>for...in</code>: 遍历的是所有&#x3D;&#x3D;可枚举&#x3D;&#x3D;的属性（包括原型）。</p>
<p><code>for...of</code>：遍历&#x3D;&#x3D;可迭代&#x3D;&#x3D;对象的&#x3D;&#x3D;属性值&#x3D;&#x3D;</p>
<h3 id="第4章：类的机制"><a href="#第4章：类的机制" class="headerlink" title="第4章：类的机制"></a>第4章：类的机制</h3><h3 id="第5章：原型"><a href="#第5章：原型" class="headerlink" title="第5章：原型"></a>第5章：原型</h3><h3 id="第6章：行为委托"><a href="#第6章：行为委托" class="headerlink" title="第6章：行为委托"></a>第6章：行为委托</h3>
            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">Post title</span>: <span class="content">《你不知道的JS上卷》</span>
        </li>
        <li class="post-author">
            <span class="type">Post author</span>: <span class="content">Chao</span>
        </li>
        <li class="post-time">
            <span class="type">Create time</span>: <span class="content">2020-12-12 13:15:00</span>
        </li>
        <li class="post-link">
            <span class="type">Post link</span>: <span class="content">2020/12/12/你不知道的JS上卷/</span>
        </li>
        <li class="post-license">
            <span class="type">Copyright notice</span>: <span class="content">All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="Copy copyright info" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/JS/">#JS</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2021/01/09/%E9%A2%84%E7%BC%96%E8%AF%91/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">JS预编译</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2020/11/11/CommonJS,%20AMD,%20CMD/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">CommonJS, AMD, CMD</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"/>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline-meta.css"/>
        <script data-pjax src="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.js"></script>
        <div id="waline-comment"></div>
        <script data-pjax>
          function loadWaline() {
            Waline.init({
              el: '#waline-comment',
              serverURL: 'https://bear-blog-comment-8yis8zzwo-xiongcao.vercel.app',
              lang: 'en' || 'zh-CN',
              comment: '.post-comments-count',
              reaction: 'true' === 'true'
            })
          }

          if ('true' === 'true') {
            setTimeout(() => {
              loadWaline()
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadWaline)
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85"><span class="nav-number">1.</span> <span class="nav-text">第一部分：作用域和闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9A%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.1.</span> <span class="nav-text">第1章：作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1. 编译原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-%E7%90%86%E8%A7%A3%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2. 理解作用域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%B5%8C%E5%A5%97"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3. 作用域嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-%E5%BC%82%E5%B8%B8"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4. 异常</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0%EF%BC%9A%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.2.</span> <span class="nav-text">第2章：词法作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1%E8%AF%8D%E6%B3%95%E9%98%B6%E6%AE%B5"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1词法阶段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E6%AC%BA%E9%AA%97%E8%AF%8D%E6%B3%95"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 欺骗词法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#eval"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">eval</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#with"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">with</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0%EF%BC%9A%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.3.</span> <span class="nav-text">第3章：函数作用域与块作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%90%E8%97%8F%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.3.1.</span> <span class="nav-text">隐藏内部实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0%EF%BC%9A%E6%8F%90%E5%8D%87"><span class="nav-number">1.4.</span> <span class="nav-text">第4章：提升</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87"><span class="nav-number">1.4.1.</span> <span class="nav-text">4.1 变量提升</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-%E5%87%BD%E6%95%B0%E4%BC%98%E5%85%88"><span class="nav-number">1.4.2.</span> <span class="nav-text">4.2 函数优先</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0%EF%BC%9A%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%97%AD%E5%8C%85"><span class="nav-number">1.5.</span> <span class="nav-text">第5章：作用域闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E5%92%8C%E9%97%AD%E5%8C%85"><span class="nav-number">1.5.1.</span> <span class="nav-text">循环和闭包</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9Athis-%E5%92%8C-%E5%AF%B9%E8%B1%A1%E5%8E%9F%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">第二部分：this 和 对象原型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0%EF%BC%9A%E5%85%B3%E4%BA%8Ethis"><span class="nav-number">2.1.</span> <span class="nav-text">第1章：关于this</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0%EF%BC%9Athis%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90"><span class="nav-number">2.2.</span> <span class="nav-text">第2章：this全面解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-%E7%BB%91%E5%AE%9A%E8%A7%84%E5%88%99"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.1 绑定规则</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-1-%E9%BB%98%E8%AE%A4%E7%BB%91%E5%AE%9A"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">2.1.1 默认绑定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-2-%E9%9A%90%E5%BC%8F%E7%BB%91%E5%AE%9A"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">2.1.2 隐式绑定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-3-%E6%98%BE%E5%BC%8F%E7%BB%91%E5%AE%9A"><span class="nav-number">2.2.1.3.</span> <span class="nav-text">2.1.3 显式绑定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-4-new%E7%BB%91%E5%AE%9A"><span class="nav-number">2.2.1.4.</span> <span class="nav-text">2.1.4 new绑定</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-%E7%BB%91%E5%AE%9A%E4%BE%8B%E5%A4%96"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2 绑定例外</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-1-%E8%A2%AB%E5%BF%BD%E7%95%A5%E7%9A%84-this"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">2.2.1 被忽略的 this</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-2-%E9%97%B4%E6%8E%A5%E5%BC%95%E7%94%A8"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">2.2.2  间接引用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0%EF%BC%9A%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.3.</span> <span class="nav-text">第3章：对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.3.1.</span> <span class="nav-text">3.1 类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E5%A4%8D%E5%88%B6%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.3.2.</span> <span class="nav-text">3.2 复制对象</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-%E6%B5%85%E6%8B%B7%E8%B4%9D%EF%BC%9A"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">3.2.1 浅拷贝：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-%E6%B7%B1%E6%8B%B7%E8%B4%9D%EF%BC%9A"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">3.2.2 深拷贝：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="nav-number">2.3.3.</span> <span class="nav-text">3.3 属性描述符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-%E4%B8%8D%E5%8F%98%E6%80%A7"><span class="nav-number">2.3.4.</span> <span class="nav-text">3.4 不变性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-%E9%81%8D%E5%8E%86"><span class="nav-number">2.3.5.</span> <span class="nav-text">3.5 遍历</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0%EF%BC%9A%E7%B1%BB%E7%9A%84%E6%9C%BA%E5%88%B6"><span class="nav-number">2.4.</span> <span class="nav-text">第4章：类的机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0%EF%BC%9A%E5%8E%9F%E5%9E%8B"><span class="nav-number">2.5.</span> <span class="nav-text">第5章：原型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC6%E7%AB%A0%EF%BC%9A%E8%A1%8C%E4%B8%BA%E5%A7%94%E6%89%98"><span class="nav-number">2.6.</span> <span class="nav-text">第6章：行为委托</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2017</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Chao</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
            <div class="icp-info info-item">
                <a target="_blank" rel="nofollow"
                   href="https://beian.miit.gov.cn"
                >
                    鄂ICP证000000001号
                </a>
            </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        $tools-item-width = 2.2rem
$tools-item-font-size = 1.1rem
$tools-item-border-radius = 0.1rem


.side-tools-container {
  position relative

  .tools-item {
    width $tools-item-width
    height $tools-item-width
    margin-bottom 0.2rem
    color var(--text-color-3)
    font-size $tools-item-font-size
    background var(--background-color-1)
    border-right none
    border-radius $tools-item-border-radius
    box-shadow 0.1rem 0.1rem 0.2rem var(--shadow-color)
    cursor pointer

    i {
      color var(--text-color-3)
    }

    &:hover {
      color var(--background-color-1)
      background var(--primary-color)
      box-shadow 0.2rem 0.2rem 0.4rem var(--shadow-color)

      i {
        color var(--background-color-1)
      }
    }

    +keep-tablet() {
      width $tools-item-width * 0.9
      height $tools-item-width * 0.9
      margin-bottom 0.2rem
      font-size $tools-item-font-size * 0.9
    }

    &.rss {

      a {
        width 100%
        height 100%
        border-radius $tools-item-border-radius

        &:hover {
          color var(--background-color-1)
          background var(--primary-color)
          box-shadow 0.2rem 0.2rem 0.4rem var(--shadow-color)
        }
      }
    }
  }


  .side-tools-list {
    transform translateX(100%)
    opacity 0
    transition-t("transform, opacity", "0, 0", "0.2, 0.2", "linear, linear")

    &.show {
      transform translateX(0)
      opacity 1
    }
  }


  .exposed-tools-list {

    if (hexo-config('style.scroll.percent') == true) {
      .tool-scroll-to-top {
        display none

        &.show {
          display flex
        }

        &:hover {

          .percent {
            display none
          }

          .arrow-up {
            display flex
          }
        }

        .arrow-up {
          display none
        }

        .percent {
          display flex
          font-size 1rem
        }
      }
    }
  }
}

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        $icon-size = 1.2rem
$search-header-height = 3rem

.search-pop-overlay {
  position fixed
  top 0
  left 0
  z-index $z-index-8
  display flex
  width 100%
  height 100%
  background rgba(0, 0, 0, 0)
  visibility hidden
  transition-t("visibility, background", "0, 0", "0.3, 0.3", "ease, ease")

  &.active {
    background rgba(0, 0, 0, 0.35)
    visibility visible

    .search-popup {
      transform scale(1)
    }
  }


  .search-popup {
    z-index $z-index-6
    width 70%
    height 80%
    margin auto
    background var(--background-color-1)
    border-radius 0.4rem
    transform scale(0)
    transition-t("transform", "0", "0.3", "ease")

    +keep-tablet() {
      width 80%
    }

    +keep-mobile() {
      width 90%
    }

    .search-header {
      display flex
      align-items center
      height $search-header-height
      padding 0 1rem
      background var(--text-color-6)
      border-top-left-radius 0.2rem
      border-top-right-radius 0.2rem

      .search-input-field-pre {
        margin-right 0.2rem
        color var(--text-color-3)
        font-size 1.3rem
        cursor pointer
      }

      .search-input-container {
        flex-grow 1
        padding 0.2rem

        .search-input {
          width 100%
          color var(--text-color-3)
          font-size 1.2rem
          background transparent
          border 0
          outline 0

          &::-webkit-search-cancel-button {
            display none
          }

          &::-webkit-input-placeholder {
            color var(--text-color-4)
            font-size 1rem
          }
        }
      }


      .close-popup-btn {
        color var(--text-color-3)
        font-size $icon-size
        cursor pointer

        &:hover {
          color var(--text-color-1)
        }
      }
    }


    #search-result {
      position relative
      display flex
      box-sizing border-box
      height 'calc(100% - %s)' % $search-header-height
      padding 0.3rem 1.5rem
      overflow auto

      .search-result-list {
        width 100%
        height 100%
        font-size 1rem

        li {
          box-sizing border-box
          margin 0.8rem 0
          padding 0.8rem 0
          border-bottom 0.1rem dashed var(--border-color)

          &:last-child {
            border-bottom none
          }


          .search-result-title {
            position relative
            display flex
            align-items center
            margin-bottom 0.8rem
            padding-left 1rem
            font-weight bold

            &::after {
              position absolute
              top 50%
              left 0
              width 0.4rem
              height 0.4rem
              background var(--text-color-3)
              border-radius 50%
              transform translateY(-50%)
              content ''
            }
          }


          .search-result {
            margin 0
            padding-left 1rem
            line-height 2rem
            word-wrap break-word
          }

          a {
            &:hover {
              color var(--text-color-3)
            }
          }

          .search-keyword {
            color var(--primary-color)
            font-weight bold
            border-bottom 0.1rem dashed var(--primary-color)
          }
        }
      }


      #no-result {
        margin auto
        color var(--text-color-4)
      }
    }
  }
}


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-block.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/post-helper.js"></script>

        
            
<script src="/js/libs/anime.min.js"></script>

        
        
            
<script src="/js/toc.js"></script>

        
    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
